<div class="login-container">
  <div class="login-dialog">
    <div class="dialog-header">
      <h2>
        <mat-icon style="vertical-align: middle; margin-right: 10px; color: var(--saffron);">
          {{ currentRoute === 'admin/login' ? 'admin_panel_settings' : (isLoginMode ? 'login' : 'person_add') }}
        </mat-icon>
        {{ currentRoute === 'admin/login' ? 'Admin Login' : (isLoginMode ? 'Welcome Back!' : 'Join BusYatra') }}
      </h2>
    </div>

    <mat-tab-group *ngIf="currentRoute !== 'admin/login'" [(selectedIndex)]="selectedIndex" (selectedIndexChange)="onTabChange($event)">
      <mat-tab label="Login">
        <div class="tab-content">
          <form [formGroup]="loginForm" (ngSubmit)="onLogin()">
            <mat-form-field appearance="outline" style="width: 100%;">
              <mat-label>
                <mat-icon style="vertical-align: middle; margin-right: 5px;">email</mat-icon>
                Email Address
              </mat-label>
              <input matInput type="email" formControlName="email" placeholder="Enter your email">
              <mat-error *ngIf="loginForm.get('email')?.hasError('required')">Email is required</mat-error>
              <mat-error *ngIf="loginForm.get('email')?.hasError('email')">Invalid email format</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" style="width: 100%;">
              <mat-label>
                <mat-icon style="vertical-align: middle; margin-right: 5px;">lock</mat-icon>
                Password
              </mat-label>
              <input matInput type="password" formControlName="password" placeholder="Enter your password">
              <mat-error *ngIf="loginForm.get('password')?.hasError('required')">Password is required</mat-error>
              <mat-error *ngIf="loginForm.get('password')?.hasError('minlength')">Password must be at least 6 characters</mat-error>
            </mat-form-field>

            <button type="submit" mat-raised-button color="primary" 
                    style="width: 100%; padding: 15px; font-size: 1.1rem; margin-top: 20px;"
                    [disabled]="isLoading || loginForm.invalid">
              <mat-spinner *ngIf="isLoading" diameter="20" style="margin-right: 10px;"></mat-spinner>
              <mat-icon *ngIf="!isLoading">login</mat-icon>
              <span>{{ isLoading ? 'Signing in...' : 'Sign In' }}</span>
            </button>
          </form>
        </div>
      </mat-tab>

      <mat-tab label="Register">
        <div class="tab-content">
          <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
            <mat-form-field appearance="outline" style="width: 100%;">
              <mat-label>
                <mat-icon style="vertical-align: middle; margin-right: 5px;">person</mat-icon>
                Full Name
              </mat-label>
              <input matInput formControlName="name" placeholder="Enter your full name">
              <mat-error *ngIf="registerForm.get('name')?.hasError('required')">Name is required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" style="width: 100%;">
              <mat-label>
                <mat-icon style="vertical-align: middle; margin-right: 5px;">email</mat-icon>
                Email Address
              </mat-label>
              <input matInput type="email" formControlName="email" placeholder="Enter your email">
              <mat-error *ngIf="registerForm.get('email')?.hasError('required')">Email is required</mat-error>
              <mat-error *ngIf="registerForm.get('email')?.hasError('email')">Invalid email format</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" style="width: 100%;">
              <mat-label>
                <mat-icon style="vertical-align: middle; margin-right: 5px;">phone</mat-icon>
                Phone Number
              </mat-label>
              <input matInput formControlName="phone" placeholder="Enter your phone number">
              <mat-error *ngIf="registerForm.get('phone')?.hasError('pattern')">Invalid phone number (10 digits)</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" style="width: 100%;">
              <mat-label>
                <mat-icon style="vertical-align: middle; margin-right: 5px;">lock</mat-icon>
                Password
              </mat-label>
              <input matInput type="password" formControlName="password" placeholder="Create password">
              <mat-error *ngIf="registerForm.get('password')?.hasError('required')">Password is required</mat-error>
              <mat-error *ngIf="registerForm.get('password')?.hasError('minlength')">Password must be at least 6 characters</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" style="width: 100%;">
              <mat-label>
                <mat-icon style="vertical-align: middle; margin-right: 5px;">lock_outline</mat-icon>
                Confirm Password
              </mat-label>
              <input matInput type="password" formControlName="confirmPassword" placeholder="Confirm password">
              <mat-error *ngIf="registerForm.hasError('mismatch') && registerForm.get('confirmPassword')?.dirty">Passwords do not match</mat-error>
            </mat-form-field>

            <button type="submit" mat-raised-button color="primary" 
                    style="width: 100%; padding: 15px; font-size: 1.1rem; margin-top: 20px;"
                    [disabled]="isLoading || registerForm.invalid">
              <mat-spinner *ngIf="isLoading" diameter="20" style="margin-right: 10px;"></mat-spinner>
              <mat-icon *ngIf="!isLoading">person_add</mat-icon>
              <span>{{ isLoading ? 'Creating Account...' : 'Create Account' }}</span>
            </button>
          </form>
        </div>
      </mat-tab>
    </mat-tab-group>

    <div class="tab-content" *ngIf="currentRoute === 'admin/login'">
      <form [formGroup]="loginForm" (ngSubmit)="onLogin()">
        <mat-form-field appearance="outline" style="width: 100%;">
          <mat-label>
            <mat-icon style="vertical-align: middle; margin-right: 5px;">email</mat-icon>
            Admin Email
          </mat-label>
          <input matInput type="email" formControlName="email" placeholder="Enter admin email">
          <mat-error *ngIf="loginForm.get('email')?.hasError('required')">Email is required</mat-error>
          <mat-error *ngIf="loginForm.get('email')?.hasError('email')">Invalid email format</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" style="width: 100%;">
          <mat-label>
            <mat-icon style="vertical-align: middle; margin-right: 5px;">lock</mat-icon>
            Password
          </mat-label>
          <input matInput type="password" formControlName="password" placeholder="Enter admin password">
          <mat-error *ngIf="loginForm.get('password')?.hasError('required')">Password is required</mat-error>
          <mat-error *ngIf="loginForm.get('password')?.hasError('minlength')">Password must be at least 6 characters</mat-error>
        </mat-form-field>

        <button type="submit" mat-raised-button color="accent" 
                style="width: 100%; padding: 15px; font-size: 1.1rem; margin-top: 20px;"
                [disabled]="isLoading || loginForm.invalid">
          <mat-spinner *ngIf="isLoading" diameter="20" style="margin-right: 10px;"></mat-spinner>
          <mat-icon *ngIf="!isLoading">security</mat-icon>
          <span>{{ isLoading ? 'Logging in as Admin...' : 'Admin Login' }}</span>
        </button>
      </form>
    </div>
  </div>
</div>
